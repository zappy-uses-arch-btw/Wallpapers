#!/bin/sh

#  ╔══════════════════════════════════════════════════════════════════╗
#  ║                        BSPWM Config                              ║
#  ╚══════════════════════════════════════════════════════════════════╝

# ─────────────────────────────────────────────────────────────────────
# Wallust Colors
# ─────────────────────────────────────────────────────────────────────
[ -f "$HOME/.config/bspwm/colors.sh" ] && . "$HOME/.config/bspwm/colors.sh"

# Fallback colors if wallust hasn't run yet
: "${color0:=#1a1b26}"
: "${color4:=#7aa2f7}"
: "${color8:=#414868}"
: "${color1:=#f7768e}"

# ─────────────────────────────────────────────────────────────────────
# Workspaces
# ─────────────────────────────────────────────────────────────────────
# 1: Terminal  |  2: Browser/Internet  |  3: Games/Apps
bspc monitor -d 1 2 3

# ─────────────────────────────────────────────────────────────────────
# Window Settings
# ─────────────────────────────────────────────────────────────────────
bspc config border_width         3
bspc config window_gap           10
bspc config split_ratio          0.50

# Colors
bspc config normal_border_color   "$color0"
bspc config active_border_color   "$color8"
bspc config focused_border_color  "$color4"
bspc config presel_feedback_color "$color1"

# ─────────────────────────────────────────────────────────────────────
# Behavior
# ─────────────────────────────────────────────────────────────────────
bspc config focus_follows_pointer true
bspc config pointer_follows_focus false
bspc config single_monocle        false
bspc config borderless_monocle    true
bspc config gapless_monocle       true

# ─────────────────────────────────────────────────────────────────────
# Window Rules (Floating)
# ─────────────────────────────────────────────────────────────────────
bspc rule -a mpv state=floating
bspc rule -a Pavucontrol state=floating
bspc rule -a "*:*:Pavucontrol" state=floating
bspc rule -a "Nm-connection-editor" state=floating
bspc rule -a "nm-connection-editor" state=floating
bspc rule -a firefox desktop='^2'
bspc rule -a Steam desktop='^3'
bspc rule -a "*:*:Picture-in-Picture" state=floating sticky=on

# ─────────────────────────────────────────────────────────────────────
# Autostart
# ─────────────────────────────────────────────────────────────────────
pgrep -x sxhkd > /dev/null || sxhkd &
pgrep -x picom > /dev/null || picom &
pgrep -x dunst > /dev/null || dunst &
~/.config/polybar/launch.sh &

# Set wallpaper if exists
[ -f ~/.cache/current_wallpaper ] && feh --bg-fill "$(cat ~/.cache/current_wallpaper)"
